
      ┌────────────────────────────────────────────────────────┐
      │  FreeKey - ожидание клавиатуры без занятия процессора  │
      └────────────────────────────────────────────────────────┘

      Версия 1.1, 05.05.1999, (c) Владимир Марфичев, г.Хабаровск



      Назначение программы
      ────────────────────
      Если Вы работаете под управлением Windows и запускаете
   DOS-задачи, то этот драйвер может Вам пригодиться.

      Почти все программы большую часть времени находятся в ожидании
   нажатия на клавиатуру. Из за особенностей Windows DOS-программы,
   запущенные в такой среде, делают это особенно неэффективно.
   Процессор при этом загружается на 100%, а работа других приложений
   и системы в целом сильно замедляется.

      Драйвер FreeKey позволяет решить эту проблему. Он "отбирает"
   кванты времени у DOS-программ, которые ждут ввода с клавиатуры,
   и отдает их системе. Благодаря этому, программа, находясь в состоянии
   простоя, не занимает процессорное время и позволяет максимально
   эффективно работать другим процессам. При этом производительность
   активной задачи снижается практически незаметно..



      Замечания для программистов
      ───────────────────────────
      Реализация идеи основана на перехвате прерывания INT 16 (Keyboard BIOS).
   Вызов функции АН=00H "Get keystroke", подменяется на функцию
                 AH=01H "Check for keystroke" с периодическим вызовом
   INT 28          (DOS IDLE INTERRUPT) и
   INT 2F/AX=1680H (MS Windows, DPMI, RELEASE CURRENT VIRTUAL MACHINE
                    TIME-SLICE),
   отдающих кванты времени системе.
   Аналогично вызов функции АН=10H "Get enhanced keystroke", подменяется
   на вызов                 AH=11H "Check for enchanced keystroke".

      Кроме того, если программа использует для чтения клавиатуры функции
   AH=01H "Check for keystroke",
   AH=02H "Get shift flags",
   AH=11H "Check for enchanced keystroke",
   AH=12H "Get enhanced shift flags", то при каждом обращении к ним
   также дополнительно вызываются INT 28 и INT 2F/AX=1680H.



      Установка
      ─────────
      Наиболее простой вариант. Пропишите вызов FREEKEY.COM
    в AUTOEXEC.BAT. Желательно самым последним из загружаемых
    резидентных драйверов.

      Можно сформировать .BAT файл для запуска конкретной DOS-программы.
    В нем перед строкой вызова этой программы необходимо добавить строку
    FREEKEY.COM
    Такую же строку добавьте и после вызова Вашей программы.
    Повторный запуск драйвера FREEKEY вызывает выгрузку его из памяти.

      После загрузки драйвер занимает резидентно 496 байт.



      И в заключении
      ──────────────
      Вы можете свободно распространять эту программу без каких-либо
      ограничений.

      Драйвер в работе проверен, данная версия - последняя.
      Тем не менее, замечания и пожелания, можно направить
      по адресу: vm@.tts.kht.ru


                                      Владимир М. Марфичев
                                      20.01.2000
