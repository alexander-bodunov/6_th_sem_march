
    ┌────────────────────────────────────────────────────────┐
    │ Рекомендации по использованию программного обеспечения │
    │              в среде Windows 3.X/9.X                   │
    └────────────────────────────────────────────────────────┘

  1. Предварительные замечания
  ----------------------------

  Программное обеспечение LM создавалось для работы в MS DOS в
которой обеспечивалась корректная работа драйвера LMDRV с
аппаратными ресурсами (COM-порты и таймер).

  Не возникает проблем и при функционировании драйвера в DOS-сессии
операционной системы OS/2.

  Отсутствие вытесняющей многозадачности в Windows 3.X и вариант
ее реализации в Windows 9.X не позволяют использовать комплекс
в DOS-сессии Windows среды.

  Предлагается следующее решение проблемы:
- драйвер LMDRV запускается до Windows;
- COM-порт с которым работает драйвер в Windows отключается;
- в среде Windows запускается только оболочка LM.EXE, которая
  выполняет взаимодействие с драйвером.


  2. Запуск в среде Windows 3.X
  -----------------------------
  Предположим COM1-мышка, COM2-телеграфный адаптер QDC-2000.

  1). Отключить COM2 для Windows.
  В файле конфигурации SYSTEM.INI в секции [386Enh]
  добавить строку
MaxCOMPort=1
  и закоментировать
;Com2AutoAssign=0

  В итоге должно выглядеть примерно так:

[386Enh]
MaxCOMPort=1
;COM3Irq=4
;COM3Base=03E8
;COM4Irq=3
;COM4Base=02E8
Com1AutoAssign=2
;Com2AutoAssign=0


  2). В файл AUTOEXEC.BAT прописать запуск LMDRV до запуска WIN.
  Например,
...
LH D:\LM\LMDRV 2
D:\LM\LM.EXE - эта строка необязательна. Но ее наличие позволит при
               запуске системы проконтролировать правильность запуска
               драйвера и состояние телеграфной линии
WIN
...

  3). В Windows создать программный элемент для запуска оболочки
      LM.EXE

  4). Удалить каталог \LM\SCR, чтобы исключить запуск
      скрин-сейверов LM

  5). Запустить оболочку LM.EXE и в Общих параметрах включить
      опцию [x] Windows

  6). Перезагрузить систему.



  3. Запуск в среде Windows 9.X
  -----------------------------
  Предположим COM1-мышка, COM2-телеграфный адаптер QDC-2000.

  1). Отключить COM2 для Windows.
  В окне
  Панель_управления/Система/Устройства/COM2/Свойства
  включить опцию: √ Отключено в данной конфигурации

  2). Для Windows 98 требуется дополнительно отключить
  ресурсы COM2.
  В окне
  Панель_управления/Система/Устройства/Компьютер/Резервирование/Добавить
  Добавить последовательно:
    Запрос на прерывание - 3
    Порт ввода-вывода    - 2F8

  3). В файл AUTOEXEC.BAT прописать запуск LMDRV
  Например,
...
LH D:\LM\LMDRV 2
D:\LM\LM.EXE - эта строка необязательна. Но ее наличие позволит при
               запуске системы проконтролировать правильность запуска
               драйвера и состояние телеграфной линии
...

  4). В Windows создать ярлык для запуска оболочки LM.EXE

  5). В свойствах ярлыка отключить выполнение в фоновом режиме

  6). Удалить каталог \LM\SCR, чтобы исключить запуск
      скрин-сейверов LM

  7). Запустить оболочку LM.EXE и в Общих параметрах включить
      опцию [x] Windows

  8). Перезагрузить систему.

   Общее замечание. Драйвер LMDRV в аварийных ситуациях выводит
на экран сообщение, сопровождаемое звуковым сигналом. Чтобы можно
было прочитать текст сообщения рекомендуется после загрузки Windows
держать постоянно запущеной оболочку LM.EXE. Если в конкретный
момент времени она не нужна можно скрыть ее или переключиться в
другое приложение.


  4. О совместной работе с другими DOS-программами
  ------------------------------------------------

  Отсутствие вытесняющей многозадачности в Windows выявило в процессе
эксплуатации еще одну проблему. При запуске некоторых DOS-задач,
в частности, написанных на языке Clarion, драйвер, как бы, не "видит" 
входящих вызовов. Точнее он их получает и обрабатывает, но с очень
большой задержкой. Происходит это потому, что активная DOS-программа
ожидая нажатия клавиатуры, занимает процессорное время на 100%, а все
остальные процессы в системе Windows обслужить не может.

  Для решения этой проблемы в поставку включается драйвер FREEKEY.COM
моей разработки.
Как он работает и что нужно, чтобы его установить, описано в файле
FREEKEY.TXT.
  Допускается распространение и использование указанного драйвера
и в системах без установленного комлекса QDC-2000.


                                      Владимир М. Марфичев
                                      20.01.2000